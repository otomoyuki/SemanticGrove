<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>中級モード - SemanticGrove</title>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

  <!-- 左サイドバー -->
  <header class="toolbar">
    <nav class="toolbar-buttons">
      {% if current_user.is_authenticated %}
        <span class="user-info">
          {{ current_user.display_name }}さん
          <span class="sg-display">💎 <span id="sgBalance">0</span> SG</span>
        </span>
      {% endif %}
      
      <a href="/" class="toolbar-button">ホーム</a>
      <a href="/main" class="toolbar-button">メイン</a>
      <a href="/readme" class="toolbar-button">README</a>
      <a href="/learn" class="toolbar-button">学習モード</a>
      <a href="/practice/low" class="toolbar-button">初級モード</a>
      <a href="/practice/middle" class="toolbar-button active">中級モード</a>
      <a href="/practice/high" class="toolbar-button">上級モード</a>
      <a href="/games" class="toolbar-button game-button">🎮ゲーム</a>
      <a href="/feedback" class="toolbar-button">ご意見</a>
      
      {% if current_user.is_authenticated %}
        <a href="/logout" class="toolbar-button logout-button">ログアウト</a>
      {% else %}
        <a href="/login" class="toolbar-button">ログイン</a>
      {% endif %}
    </nav>
  </header>

  <!-- メインコンテンツ -->
  <div class="main-content">
    <h1 class="logo-title">SemanticGrove</h1>
    <h2>中級モード（実践練習）</h2>

    <!-- セットアップエリア -->
    <div id="setupArea" class="setup-area">
      <div class="language-select" style="background: transparent; margin: 0; padding: 0;">
        <label for="language">言語を選択：</label>
        <select id="language">
          <option value="Python">Python</option>
          <option value="JavaScript">JavaScript</option>
          <option value="Java">Java</option>
          <option value="C++">C++</option>
          <option value="C#">C#</option>
          <option value="PHP">PHP</option>
          <option value="Ruby">Ruby</option>
          <option value="Go">Go</option>
          <option value="Swift">Swift</option>
          <option value="Kotlin">Kotlin</option>
          <option value="TypeScript">TypeScript</option>
          <option value="Rust">Rust</option>
          <option value="SQL">SQL</option>
          <option value="HTML/CSS">HTML/CSS</option>
          <option value="React">React</option>
          <option value="VBA">VBA</option>
          <option value="IQ">IQ</option>
        </select>
      </div>

      <!-- 問題数選択 -->
      <div class="question-count-selector">
        <label for="questionCount">出題数：</label>
        <select id="questionCount">
          <option value="10">10問</option>
          <option value="20">20問</option>
          <option value="30">30問</option>
          <option value="50">50問</option>
        </select>
      </div>

      <div class="start-button-area">
        <button onclick="startMiddleMode()">開始</button>
      </div>
    </div>

    <!-- スコア表示 -->
    <div id="scoreDisplay" class="score-display" style="display: none;">
      問題 <span id="currentQuestion">1</span> / <span id="totalQuestions">10</span> | 
      正解数: <span id="correctCount">0</span> | 
      正答率: <span id="accuracyRate">0</span>%
    </div>

    <!-- 問題エリア -->
    <div id="questionArea" class="question-box" style="display: none;">
      <h3 id="questionText">問題文がここに表示されます</h3>
      <div id="choicesArea" class="choices"></div>
    </div>

    <!-- フィードバック -->
    <div id="feedbackArea" class="feedback" style="display: none;"></div>

    <!-- 解説 -->
    <div id="explanationArea" class="explanation-box" style="display: none;">
      <h4>📖 解説</h4>
      <p id="explanationText"></p>
      <h4>💡 学習ポイント</h4>
      <p id="learningPointText"></p>
    </div>

    <!-- 次へボタン -->
    <div id="nextButtonArea" class="next-button-area" style="display: none;">
      <button onclick="goNextMiddle()">次の問題へ →</button>
    </div>

    <!-- 結果エリア -->
    <div id="resultArea" class="result-box" style="display: none;">
      <h2>🎉 練習完了！</h2>
      <div class="result-stats">
        <p>総問題数: <span id="finalTotal">0</span>問</p>
        <p>正解数: <span id="finalCorrect">0</span>問</p>
        <p>不正解数: <span id="finalIncorrect">0</span>問</p>
        <p>正答率: <span id="finalAccuracy">0</span>%</p>
        <p>スコア: <span id="finalScore">0</span>点</p>
      </div>
      <div class="result-buttons">
        <button onclick="restartMiddle()">もう一度挑戦</button>
        <button onclick="location.href='/'">ホームに戻る</button>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='practice-middle.js') }}"></script>
  <script src="{{ url_for('static', filename='sg-balance.js') }}"></script>
</body>
</html>