import sqlite3
import json

DB_NAME = "SemanticGrove.db"

def add_vba_20_questions_part1():
    """VBAå•é¡Œ20å•è¿½åŠ ï¼ˆç¬¬1å¼¾ï¼š10å•â†’30å•ï¼‰"""
    conn = sqlite3.connect(DB_NAME)
    cursor = conn.cursor()
    
    print("=" * 60)
    print("VBAå•é¡Œè¿½åŠ ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆç¬¬1å¼¾ï¼š20å•ï¼‰")
    print("=" * 60)
    
    questions = []
    
    # ==================== åŸºæœ¬æ–‡æ³•ï¼ˆ10å•ï¼‰ ====================
    print("[1/2] åŸºæœ¬æ–‡æ³•ã‚’ç”Ÿæˆä¸­...")
    
    basics = [
        ("VBAã®å¤‰æ•°å®£è¨€ã§æ­£ã—ã„ã®ã¯ï¼Ÿ",
         [{"id":"A","text":"Dim name As String"},{"id":"B","text":"var name: String"},{"id":"C","text":"String name"},{"id":"D","text":"let name = String"}],
         [0], "åŸºæœ¬æ–‡æ³•", "1", 5, "å¤‰æ•°ã®å®šç¾©", "Dim"),
        
        ("å®šæ•°ã®å®£è¨€æ–¹æ³•ã¯ï¼Ÿ",
         [{"id":"A","text":"Const MAX_SIZE As Integer = 100"},{"id":"B","text":"Dim Const MAX_SIZE = 100"},{"id":"C","text":"final MAX_SIZE = 100"},{"id":"D","text":"readonly MAX_SIZE As Integer = 100"}],
         [0], "åŸºæœ¬æ–‡æ³•", "2", 7, "å®šæ•°ã®å®šç¾©", "Const"),
        
        ("Option Explicitã®å½¹å‰²ã¯ï¼Ÿ",
         [{"id":"A","text":"å¤‰æ•°ã®å®£è¨€ã‚’å¼·åˆ¶"},{"id":"B","text":"å³å¯†ãªå‹ãƒã‚§ãƒƒã‚¯"},{"id":"C","text":"ã‚¨ãƒ©ãƒ¼ã‚’ç„¡è¦–"},{"id":"D","text":"ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰"}],
         [0], "åŸºæœ¬æ–‡æ³•", "2", 8, "å®£è¨€ã®å¿…é ˆåŒ–", "Option Explicit"),
        
        ("VBAã®ã‚³ãƒ¡ãƒ³ãƒˆè¨˜å·ã¯ï¼Ÿ",
         [{"id":"A","text":"'ï¼ˆã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆï¼‰"},{"id":"B","text":"//"},{"id":"C","text":"#"},{"id":"D","text":"/**/"}],
         [0], "åŸºæœ¬æ–‡æ³•", "1", 5, "æ³¨é‡ˆã®è¨˜è¿°", "comment"),
        
        ("è¤‡æ•°è¡Œã«ã¾ãŸãŒã‚‹ã‚³ãƒ¼ãƒ‰ã®è¨˜è¿°ã¯ï¼Ÿ",
         [{"id":"A","text":"_ï¼ˆã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ï¼‰ã§è¡Œã‚’ç¶™ç¶š"},{"id":"B","text":"\\ï¼ˆãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ï¼‰"},{"id":"C","text":"+ï¼ˆãƒ—ãƒ©ã‚¹ï¼‰"},{"id":"D","text":"æ”¹è¡Œã®ã¿"}],
         [0], "åŸºæœ¬æ–‡æ³•", "2", 7, "è¡Œã®ç¶™ç¶š", "line continuation"),
        
        ("VBAã®ãƒ‡ãƒ¼ã‚¿å‹ã§ãªã„ã‚‚ã®ã¯ï¼Ÿ",
         [{"id":"A","text":"float"},{"id":"B","text":"Integer"},{"id":"C","text":"String"},{"id":"D","text":"Boolean"}],
         [0], "åŸºæœ¬æ–‡æ³•", "2", 7, "å‹ã®ç†è§£", "data type"),
        
        ("Variantãƒ‡ãƒ¼ã‚¿å‹ã®ç‰¹å¾´ã¯ï¼Ÿ",
         [{"id":"A","text":"ä»»æ„ã®å‹ã‚’æ ¼ç´ã§ãã‚‹"},{"id":"B","text":"æ•´æ•°ã®ã¿"},{"id":"C","text":"æ–‡å­—åˆ—ã®ã¿"},{"id":"D","text":"ä½¿ç”¨ä¸å¯"}],
         [0], "åŸºæœ¬æ–‡æ³•", "2", 8, "æ±ç”¨å‹", "Variant"),
        
        ("æ–‡å­—åˆ—ã®é€£çµæ¼”ç®—å­ã¯ï¼Ÿ",
         [{"id":"A","text":"& ã¾ãŸã¯ +"},{"id":"B","text":"concat()"},{"id":"C","text":"append()"},{"id":"D","text":"join()"}],
         [0], "åŸºæœ¬æ–‡æ³•", "1", 5, "æ–‡å­—åˆ—çµåˆ", "concatenation"),
        
        ("ä»£å…¥æ¼”ç®—å­ã¯ï¼Ÿ",
         [{"id":"A","text":"= ã¾ãŸã¯ Setï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰"},{"id":"B","text":":="},{"id":"C","text":"<-"},{"id":"D","text":"=>"}],
         [0], "åŸºæœ¬æ–‡æ³•", "2", 7, "å€¤ã®ä»£å…¥", "assignment"),
        
        ("æ¯”è¼ƒæ¼”ç®—å­ã§ç­‰ã—ã„ã“ã¨ã‚’è¡¨ã™ã®ã¯ï¼Ÿ",
         [{"id":"A","text":"="},{"id":"B","text":"=="},{"id":"C","text":"==="},{"id":"D","text":"eq"}],
         [0], "åŸºæœ¬æ–‡æ³•", "1", 5, "ç­‰ä¾¡æ¯”è¼ƒ", "equality"),
    ]
    
    questions.extend(basics)
    print(f"  âœ“ åŸºæœ¬æ–‡æ³•: {len(basics)}å•")
    
    # ==================== åˆ¶å¾¡æ§‹æ–‡ï¼ˆ10å•ï¼‰ ====================
    print("[2/2] åˆ¶å¾¡æ§‹æ–‡ã‚’ç”Ÿæˆä¸­...")
    
    controls = [
        ("Ifæ–‡ã®åŸºæœ¬å½¢ã¯ï¼Ÿ",
         [{"id":"A","text":"If condition Then ... End If"},{"id":"B","text":"if (condition) { ... }"},{"id":"C","text":"if condition: ..."},{"id":"D","text":"If condition Do ... Loop"}],
         [0], "åˆ¶å¾¡æ§‹æ–‡", "1", 5, "æ¡ä»¶åˆ†å²", "If"),
        
        ("ElseIfã®è¨˜è¿°ã¯ï¼Ÿ",
         [{"id":"A","text":"ElseIf condition Then"},{"id":"B","text":"Else If condition Then"},{"id":"C","text":"elif condition:"},{"id":"D","text":"else if (condition)"}],
         [0], "åˆ¶å¾¡æ§‹æ–‡", "2", 7, "è¤‡æ•°æ¡ä»¶", "ElseIf"),
        
        ("Select Caseã®åŸºæœ¬å½¢ã¯ï¼Ÿ",
         [{"id":"A","text":"Select Case å¤‰æ•° Case å€¤ ... End Select"},{"id":"B","text":"switch (å¤‰æ•°) { case å€¤: ... }"},{"id":"C","text":"case å¤‰æ•° when å€¤ ..."},{"id":"D","text":"match å¤‰æ•° { å€¤ => ... }"}],
         [0], "åˆ¶å¾¡æ§‹æ–‡", "2", 7, "å¤šå²åˆ†å²", "Select Case"),
        
        ("For...Nextãƒ«ãƒ¼ãƒ—ã®åŸºæœ¬å½¢ã¯ï¼Ÿ",
         [{"id":"A","text":"For i = 1 To 10 ... Next i"},{"id":"B","text":"for (i = 1; i <= 10; i++) { ... }"},{"id":"C","text":"for i in range(1, 10): ..."},{"id":"D","text":"foreach i in 1..10 { ... }"}],
         [0], "åˆ¶å¾¡æ§‹æ–‡", "1", 5, "ã‚«ã‚¦ãƒ³ã‚¿ãƒ«ãƒ¼ãƒ—", "For Next"),
        
        ("Stepã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®å½¹å‰²ã¯ï¼Ÿ",
         [{"id":"A","text":"å¢—æ¸›å€¤ã‚’æŒ‡å®šï¼ˆFor i = 1 To 10 Step 2ï¼‰"},{"id":"B","text":"ãƒ«ãƒ¼ãƒ—ã‚’æŠœã‘ã‚‹"},{"id":"C","text":"æ¬¡ã®åå¾©ã¸"},{"id":"D","text":"æ¡ä»¶åˆ¤å®š"}],
         [0], "åˆ¶å¾¡æ§‹æ–‡", "2", 7, "å¢—åˆ†ã®æŒ‡å®š", "Step"),
        
        ("For Each...Nextã®ç”¨é€”ã¯ï¼Ÿ",
         [{"id":"A","text":"ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®å„è¦ç´ ã‚’å‡¦ç†"},{"id":"B","text":"æ•°å€¤ã®ç¯„å›²æŒ‡å®š"},{"id":"C","text":"æ¡ä»¶åˆ¤å®š"},{"id":"D","text":"ç„¡é™ãƒ«ãƒ¼ãƒ—"}],
         [0], "åˆ¶å¾¡æ§‹æ–‡", "2", 8, "è¦ç´ ã®èµ°æŸ»", "For Each"),
        
        ("Do While...Loopã®ç‰¹å¾´ã¯ï¼Ÿ",
         [{"id":"A","text":"æ¡ä»¶ãŒçœŸã®é–“ç¹°ã‚Šè¿”ã™ï¼ˆå‰åˆ¤å®šï¼‰"},{"id":"B","text":"æ¡ä»¶ãŒå½ã®é–“ç¹°ã‚Šè¿”ã™"},{"id":"C","text":"å¿…ãš1å›ã¯å®Ÿè¡Œ"},{"id":"D","text":"ç„¡é™ãƒ«ãƒ¼ãƒ—"}],
         [0], "åˆ¶å¾¡æ§‹æ–‡", "2", 7, "å‰åˆ¤å®šãƒ«ãƒ¼ãƒ—", "Do While"),
        
        ("Do...Loop Whileã®ç‰¹å¾´ã¯ï¼Ÿ",
         [{"id":"A","text":"å¿…ãš1å›ã¯å®Ÿè¡Œï¼ˆå¾Œåˆ¤å®šï¼‰"},{"id":"B","text":"å®Ÿè¡Œã•ã‚Œãªã„å ´åˆã‚ã‚Š"},{"id":"C","text":"ç„¡é™ãƒ«ãƒ¼ãƒ—"},{"id":"D","text":"Do Whileã¨åŒã˜"}],
         [0], "åˆ¶å¾¡æ§‹æ–‡", "2", 8, "å¾Œåˆ¤å®šãƒ«ãƒ¼ãƒ—", "Loop While"),
        
        ("Exit Forã®å½¹å‰²ã¯ï¼Ÿ",
         [{"id":"A","text":"Forãƒ«ãƒ¼ãƒ—ã‚’æŠœã‘ã‚‹"},{"id":"B","text":"ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’æŠœã‘ã‚‹"},{"id":"C","text":"æ¬¡ã®åå¾©ã¸"},{"id":"D","text":"ãƒ—ãƒ­ã‚°ãƒ©ãƒ çµ‚äº†"}],
         [0], "åˆ¶å¾¡æ§‹æ–‡", "2", 7, "ãƒ«ãƒ¼ãƒ—è„±å‡º", "Exit For"),
        
        ("Exit Subã®å½¹å‰²ã¯ï¼Ÿ",
         [{"id":"A","text":"Subãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’æŠœã‘ã‚‹"},{"id":"B","text":"Functionã‚’æŠœã‘ã‚‹"},{"id":"C","text":"ãƒ«ãƒ¼ãƒ—ã‚’æŠœã‘ã‚‹"},{"id":"D","text":"ãƒ—ãƒ­ã‚°ãƒ©ãƒ çµ‚äº†"}],
         [0], "åˆ¶å¾¡æ§‹æ–‡", "2", 7, "ã‚µãƒ–ãƒ«ãƒ¼ãƒãƒ³çµ‚äº†", "Exit Sub"),
    ]
    
    questions.extend(controls)
    print(f"  âœ“ åˆ¶å¾¡æ§‹æ–‡: {len(controls)}å•")
    
    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æŒ¿å…¥
    print("\nãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ä¸­...")
    for q in questions:
        question_json = {
            "question": q[0],
            "options": q[1],
            "answer": q[2]
        }
        
        cursor.execute("""
            INSERT INTO questions 
            (language, question_json, category, difficulty, score, meaning, usage)
            VALUES (?, ?, ?, ?, ?, ?, ?)
        """, ("VBA", json.dumps(question_json, ensure_ascii=False), 
              q[3], q[4], q[5], q[6], q[7]))
    
    conn.commit()
    
    # çµ±è¨ˆè¡¨ç¤º
    cursor.execute("SELECT COUNT(*) FROM questions WHERE language = 'VBA'")
    vba_count = cursor.fetchone()[0]
    
    cursor.execute("SELECT COUNT(*) FROM questions")
    total_count = cursor.fetchone()[0]
    
    conn.close()
    
    print("\n" + "=" * 60)
    print(f"âœ… VBA ç¬¬1å¼¾å®Œäº†: {vba_count}å•")
    print("=" * 60)
    print(f"VBAå•é¡Œæ•°: 10å• â†’ {vba_count}å•ï¼ˆ+20å•ï¼‰")
    print(f"å…¨ä½“å•é¡Œæ•°: {total_count}å•")
    print("\nã€è¿½åŠ å†…å®¹ã€‘")
    print("  âœ“ åŸºæœ¬æ–‡æ³•: 10å•")
    print("  âœ“ åˆ¶å¾¡æ§‹æ–‡: 10å•")
    print("\nğŸ¯ æ¬¡å›: ç¬¬2å¼¾ã§æ®‹ã‚Š20å•è¿½åŠ  â†’ 50å•é”æˆ")
    print("=" * 60)

if __name__ == "__main__":
    add_vba_20_questions_part1()